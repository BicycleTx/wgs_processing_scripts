#!/usr/bin/env bash

metadata_tsv=$1 && shift
rna_output_dir=$1 && shift

rnaOverview="/data/data_archive/rna_seq/overview/overview.tsv"

cat ${metadata_tsv} | grep -v "^#" | cut -f3 | while read sampleId; do
    echo "[INFO] Checking $sampleId"
    fastqPath=$( cat ${rnaOverview} | awk -v sampleId="${sampleId}" '$1 == sampleId' | cut -f4)
    if [[ "${fastqPath}" ]]; then
        echo "[INFO]   found $fastqPath"
        ln -s ${fastqPath} ${rna_output_dir}/
    fi
done
