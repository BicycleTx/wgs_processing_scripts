SELECT primaryTumorLocation, cuppaTumorLocation, b.reportedType, dnaFusionCount, a.*
FROM
(SELECT * FROM rnaFusion WHERE name IN ('ACSL3_ETV1','ACTB_GLI1','ACTB_TFEB','ACTG2_ALK','AGAP3_BRAF','AGGF1_PDGFRB','AGK_BRAF','AGR2_ETV1','AHRR_NCOA2','AKAP9_BRAF','ASPSCR1_TFE3','ATF7IP_JAK2','ATF7IP_PDGFRB','ATIC_ALK','ATP1B1_NRG1','BCAN_NTRK1','BCOR_CCNB3','BCOR_MAML3','BCOR_RARA','BCR_ABL1','BCR_FGFR1','BCR_JAK2','BCR_NTRK2','BCR_PDGFRA','BIRC3_MALT1','BRD3_NUTM1','BRD4_NUTM1','C11orf95_MKL2','C11orf95_RELA','CANT1_ETV4','CARS_ALK','CBFA2T3_GLIS2','CBFB_MYH11','CCDC6_RET','CCDC6_ROS1','CCDC88C_PDGFRB','CD74_NRG1','CD74_NTRK1','CD74_ROS1','CDH11_USP6','CDK5RAP2_PDGFRA','CDKN2D_WDFY2','CEP85L_PDGFRB','CEP85L_ROS1','CHCHD7_PLAG1','CHD7_BEND2','CIC_DUX4','CIC_FOXO4','CIC_NUTM1','CLCN6_BRAF','CLTC_ALK','CLTC_TFE3','CLTC_TFEB','CNTRL_FGFR1','COL1A1_PDGFB','COL1A1_USP6','COL1A2_PLAG1','COL3A1_PLAG1','CRTC1_MAML2','CRTC3_MAML2','CTLA4_CD28','CTNNB1_PLAG1','CUL1_BRAF','CUX1_BRAF','CUX1_FGFR1','DCTN1_ALK','DEK_NUP214','DNAJB1_PRKACA','DTD1_PDGFRB','EBF1_PDGFRB','EGFR_RAD51','EGFR_SEPT14','EIF3E_RSPO2','EML1_ABL1','EML4_ALK','EML4_NTRK3','EP300_ZNF384','EP400_PHF1','EPC1_PHF1','EPCAM_MSH2','ERC1_RET','ETV6_ABL1','ETV6_ABL2','ETV6_ACSL6','ETV6_FLT3','ETV6_JAK2','ETV6_LYN','ETV6_NTRK3','ETV6_PDGFRA','ETV6_PDGFRB','ETV6_RUNX1','EWSR1_ATF1','EWSR1_CREB1','EWSR1_CREB3L1','EWSR1_CREM','EWSR1_DDIT3','EWSR1_ERG','EWSR1_ETV1','EWSR1_ETV4','EWSR1_FEV','EWSR1_FLI1','EWSR1_KLF17','EWSR1_NFATC2','EWSR1_NR4A3','EWSR1_PATZ1','EWSR1_PBX1','EWSR1_PBX3','EWSR1_POU5F1','EWSR1_SP3','EWSR1_TFEB','EWSR1_WT1','EWSR1_YY1','EWSR1_ZNF444','EZR_ROS1','FAM131B_BRAF','FGFR1_PLAG1','FGFR1_TACC1','FGFR1OP_FGFR1','FGFR1OP2_FGFR1','FGFR2_AHCYL1','FGFR2_BICC1','FGFR2_CCDC6','FGFR2_MGEA5','FGFR2_PPHLN1','FGFR3_BAIAP2L1','FGFR3_JAKMIP1','FGFR3_TACC3','FIP1L1_PDGFRA','FN1_ALK','FN1_FGFR1','FOXP1_ABL1','FUS_ATF1','FUS_CREB3L1','FUS_CREB3L2','FUS_DDIT3','FUS_ERG','FUS_FEV','FUS_KLF17','FUS_TFCP2','GIT2_PDGFRB','GNAI1_BRAF','GOPC_ROS1','GTF2I_RARA','HAS2_PLAG1','HEY1_NCOA2','HIP1_ALK','HIP1_PDGFRB','HMGA2_ACKR3','HMGA2_EBF1','HMGA2_LHFP','HMGA2_LPP','HMGA2_NFIB','HMGA2_PPAP2B','HMGA2_SETBP1','HMGA2_WIF1','HMGN2P46_MYC','HNRNPA2B1_ETV1','HOOK3_RET','IRF2BP2_CDX1','IRF2BP2_NTRK1','ITK_SYK','JAZF1_PHF1','JAZF1_SUZ12','KANK1_PDGFRB','KAT6A_CREBBP','KAT6A_EP300','KAT6A_NCOA2','KAT6B_KANSL1','KCTD8_NTRK2','KDELR2_ROS1','KDR_PDGFRA','KIAA1549_BRAF','KIF5B_ALK','KIF5B_MET','KIF5B_PDGFRA','KIF5B_RET','KLC1_ALK','KLK2_ETV1','KLK2_ETV4','KMT2A_ABI1','KMT2A_ACTN4','KMT2A_AFF1','KMT2A_AFF3','KMT2A_AFF4','KMT2A_ARHGAP26','KMT2A_BTBD18','KMT2A_CBL','KMT2A_CEP170B','KMT2A_CREBBP','KMT2A_ELL','KMT2A_EP300','KMT2A_EPS15','KMT2A_FLNA','KMT2A_FOXO3','KMT2A_FOXO4','KMT2A_GAS7','KMT2A_GPHN','KMT2A_KIAA1524','KMT2A_LASP1','KMT2A_MAML2','KMT2A_MLLT1','KMT2A_MLLT10','KMT2A_MLLT11','KMT2A_MLLT3','KMT2A_MLLT4','KMT2A_MLLT6','KMT2A_MYO1F','KMT2A_NCKIPSD','KMT2A_NEBL','KMT2A_PICALM','KMT2A_SEPT2','KMT2A_SEPT5','KMT2A_SEPT6','KMT2A_SEPT9','KMT2A_TET1','KMT2A_TNRC18','KMT2E_ASNS','LIFR_PLAG1','LIMA1_ROS1','LMNA_NTRK1','LRIG3_ROS1','MALAT1_TFEB','MBTD1_CXorf67','MEAF6_PHF1','MEF2D_BCL9','MEF2D_CSF1R','MKRN1_BRAF','MN1_ETV6','MN1_PATZ1','MNX1_ETV6','MPRIP_NTRK1','MSMB_ERG','MSN_ALK','MSN_ROS1','MYB_NFIB','MYBL1_NFIB','MYH9_USP6','MYO5A_NTRK3','NAB2_STAT6','NCOA4_RET','NDRG1_ERG','NFASC_NTRK1','NONO_TFE3','NOS1AP_NTRK2','NPM1_ALK','NPM1_MLF1','NPM1_RARA','NUP214_ABL1','NUP98_ADD3','NUP98_DDX10','NUP98_HOXA13','NUP98_HOXA9','NUP98_HOXC11','NUP98_HOXD13','NUP98_KDM5A','NUP98_NSD1','NUP98_PHF23','NUP98_PSIP1','NUP98_RAP1GDS1','OMD_USP6','P2RY8_CRLF2','PAPSS1_BRAF','PAX3_FOXO1','PAX3_MAML3','PAX3_NCOA1','PAX3_NCOA2','PAX5_AUTS2','PAX5_ELN','PAX5_ETV6','PAX5_JAK2','PAX5_PML','PAX7_FOXO1','PAX8_GLIS3','PAX8_PPARA','PAX8_PPARG','PCM1_JAK2','PICALM_MLLT10','PML_PRAM1','PML_RARA','PPFIBP1_ALK','PRCC_TFE3','PRKAR1A_RET','PRKG2_PDGFRB','PTPRK_RSPO3','PTPRZ1_MET','QKI_NTRK2','QKI_RAF1','RAB2A_PLAG1','RABEP1_PDGFRB','RANBP2_ALK','RBM10_TFE3','RBM15_MAL','RBPMS_NTRK3','RCSD1_ABL1','RNF130_BRAF','RPN1_MECOM','RREB1_MKL2','RUNX1_CBFA2T3','RUNX1_MECOM','RUNX1_PRDM16','RUNX1_RUNX1T1','RUNX1_USP42','SDC4_ROS1','SEC31A_ALK','SEC31A_JAK2','SERPINE1_FOSB','SET_NUP214','SFPQ_ABL1','SFPQ_TFE3','SLC34A2_ROS1','SLC3A2_NRG1','SLC44A1_PRKCA','SLC45A3_BRAF','SLC45A3_ERG','SLC45A3_ETV1','SLC45A3_ETV5','SND1_BRAF','SNX2_ABL1','SPTBN1_PDGFRB','SQSTM1_ALK','SQSTM1_NTRK1','SRF_NCOA2','SRGAP3_RAF1','SS18_SSX1','SS18_SSX2','SS18_SSX4','SS18L1_SSX1','SSBP2_JAK2','STAT5B_RARA','STIL_TAL1','STRN_ALK','STRN_NTRK2','STRN_PDGFRA','STRN3_JAK2','TAF15_NR4A3','TAF15_ZNF384','TBL1XR1_TP63','TCEA1_PLAG1','TCF12_NR4A3','TCF3_PBX1','TEAD1_NCOA2','TFG_ALK','TFG_NR4A3','TFG_NTRK1','TFG_ROS1','TGFBR3_MGEA5','TGFBR3_PLAG1','THADA_IGF2BP3','THRAP3_USP6','TLX3_BCL11B','TMPRSS2_ERG','TMPRSS2_ETV1','TMPRSS2_ETV4','TMPRSS2_ETV5','TNKS2_PDGFRA','TNS1_ALK','TP53BP1_PDGFRB','TPM3_ALK','TPM3_NTRK1','TPM3_ROS1','TPM4_ALK','TPR_ALK','TPR_MET','TPR_NTRK1','TRAF1_ALK','TRIM24_BRAF','TRIM33_RET','UBE2L3_KRAS','VCL_ALK','WHSC1L1_NUTM1','WWTR1_CAMTA1','YAP1_FAM118B','YAP1_MAMLD1','YAP1_TFE3','YWHAE_NUTM2A','YWHAE_NUTM2B','YWHAE_ROS1','ZBTB16_RARA','ZC3H7B_BCOR','ZFP36_FOSB','ZFP36_FOSB','ZMIZ1_ABL1','ZMYM2_FGFR1','RP11-356O9.1_ETV1','CSF1_COL6A3','CSF1_VCAM1','CSF1_FN1','CSF1_CDH1','EWSR1_TFCP2','VGLL2_CITED2','VGLL2_NCOA2','EWSR1_SSX1','YWHAE_IQCK','FGFR2_TACC2','TCF3_HLF','EIF5A_TERT','NRF1_BRAF','SRF_ICA1L','SRF_E2F1','SRF_FOXO1','SRF_RELA','SRF_NCOA1','HMGA2_NCOR2','VGLL2_NCOA1'))
    AS a
LEFT JOIN (SELECT distinct name, reportedType, count(*) AS dnaFusionCount FROM svFusion GROUP BY 1,2) AS b
    ON a.name=b.name
LEFT JOIN svFusion
    ON a.sampleId=svFusion.sampleId AND b.name=svFusion.name
LEFT JOIN clinical
    ON a.sampleId=clinical.sampleId
LEFT JOIN cuppa
    ON a.sampleId=cuppa.sampleId
WHERE svFusion.sampleId IS NULL AND a.sampleId IN ('XXX')
ORDER BY b.reportedType, a.name, a.sampleId;