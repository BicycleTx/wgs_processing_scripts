#!/bin/bash

sample=$1

run_info=`query_sbp_api -type runs | grep -P "\t${sample}\t" | grep "Somatic.ini\|CPCT.ini" | grep "Validated" `
if [ -z "$run_info" ]; then
    echo "[WARN] No validated runs found with a Somatic/CPCT .ini file for sample ${sample}. Exiting."
    exit 1
fi

set=`echo ${run_info} | cut -d ' ' -f1`

echo "[INFO] Downloading set ${set} for sample ${sample}"
download_set -s ${set} -p /data/schuberg/cpct_drup_downloads