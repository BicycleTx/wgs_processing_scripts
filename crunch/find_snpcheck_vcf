#!/usr/bin/env bash

source message_functions || exit 1

print_usage(){
    echo "-----"
    echo " Descr: Searches for SNPcheck VCFs in GCP (gs://hmf-snpcheck/snpcheckvcfs/)."
    echo " Usage: $(basename $0) \$search_string"
    echo "        $(basename $0) FR12345678"
    echo "-----"
    exit 1
}

search=$1
[[ -n "${search}" ]] || print_usage


#echo ""
#info "Checking remote location for VCFs (gs://${gcp_bucket})"
if [[ $( gsutil ls "gs://hmf-snpcheck/snpcheckvcfs/*/*${search}*" | grep -v "Duplo" | head -1 | wc -l ) == 1 ]]; then
    gsutil ls "gs://hmf-snpcheck/snpcheckvcfs/*/*${search}*" | grep -v "Duplo" | head -1
else
    warn "No snpcheckvcf is found in gs://hmf-snpcheck/snpcheckvcfs/ for ${search}"
fi
#echo ""

# since January 2021 logs are no longer written to the snpchecklogs
#info "Checking remote location for LOGs (gs://${gcp_bucket})"
#gsutil ls "gs://hmf-snpcheck/snpchecklogs/*${search}*"
#echo ""
