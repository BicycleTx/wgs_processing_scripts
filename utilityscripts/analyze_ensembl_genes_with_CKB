#!/usr/bin/env bash

genesCKB=/data/experiments/check_ensembl_versus_CKB_genes/input/210903_CKB_genes.tsv
genes_map_37_89=/data/experiments/check_ensembl_versus_CKB_genes/input/genes_map_37_89.tsv
genes_map_38_104=/data/experiments/check_ensembl_versus_CKB_genes/input/genes_map_38_104.tsv
genes_map_38_89=/data/experiments/check_ensembl_versus_CKB_genes/input/genes_map_38_89.tsv

echo "geneSymbol;geneSynonyms;genes_map_37_89" > /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_37_89.csv
echo "geneSymbol;geneSynonyms;genes_map_38_104" > /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_38_104.csv
echo "geneSymbol;geneSynonyms;genes_map_38_89" > /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_38_89.csv

##checking genes of CKB present in ensembl
sed 1d ${genesCKB} | while IFS= read genes; do

    geneSymbol=$( echo ${genes} | awk '{print $1}')
    synonym=$( echo ${genes} | awk '{print $2}')
    present_genes_map_37_89=$( cat ${genes_map_37_89} | awk '{print $2}' | grep -w ${geneSymbol} | wc -l)
    present_genes_map_38_104=$( cat ${genes_map_38_104} | awk '{print $2}' | grep -w ${geneSymbol} | wc -l)
    present_genes_map_38_89=$( cat ${genes_map_38_89} | awk '{print $2}' | grep -w ${geneSymbol} | wc -l)

    if [[ ${present_genes_map_37_89} -eq 1 ]]; then
    	echo "${geneSymbol};${synonym};true" >> /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_37_89.csv
    else
      echo "${geneSymbol};${synonym};false" >> /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_37_89.csv
    fi

    if [[ ${present_genes_map_38_104} -eq 1 ]]; then
    	echo "${geneSymbol};${synonym};true" >> /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_38_104.csv
    else
      echo "${geneSymbol};${synonym};false" >> /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_38_104.ccsv
    fi

    if [[ ${present_genes_map_38_89} -eq 1 ]]; then
    	echo "${geneSymbol};${synonym};true" >> /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_38_89.csv
    else
      echo "${geneSymbol};${synonym};false" >> /data/experiments/check_ensembl_versus_CKB_genes/output/CKB_versus_genes_map_38_89.csv
    fi

done < ${genesCKB}

##checking genes of ensembl 37_89 present in CKB
echo "geneSymbol;genes_map_37_89" > /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_37_89_versus_CKB.csv

sed 1d ${genes_map_37_89} | while IFS= read genes; do

    geneSymbol=$( echo ${genes} | awk '{print $2}')
    present_CKB_genes=$( cat ${genesCKB} | awk '{print $1}' | grep -w ${geneSymbol} | wc -l)

    if [[ ${present_CKB_genes} -eq 1 ]]; then
    	echo "${geneSymbol};true" >> /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_37_89_versus_CKB.csv
    else
	    echo "${geneSymbol};false" >> /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_37_89_versus_CKB.csv
    fi

done < ${genes_map_37_89}

##checking genes of ensembl 38_104 present in CKB
echo "geneSymbol;genes_map_38_104" > /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_38_104_versus_CKB.csv

sed 1d ${genes_map_37_89} | while IFS= read genes; do

    geneSymbol=$( echo ${genes} | awk '{print $2}')
    present_CKB_genes=$( cat ${genesCKB} | awk '{print $1}' | grep -w ${geneSymbol} | wc -l)

    if [[ ${present_CKB_genes} -eq 1 ]]; then
    	echo "${geneSymbol};true" >> /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_38_104_versus_CKB.csv
    else
	    echo "${geneSymbol};false" >> /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_38_104_versus_CKB.csv
    fi

done < ${genes_map_37_89}

##checking genes of ensembl 38_89 present in CKB
echo "geneSymbol;genes_map_38_89" > /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_38_89_versus_CKB.csv

sed 1d ${genes_map_37_89} | while IFS= read genes; do

    geneSymbol=$( echo ${genes} | awk '{print $2}')
    present_CKB_genes=$( cat ${genesCKB} | awk '{print $1}' | grep -w ${geneSymbol} | wc -l)

    if [[ ${present_CKB_genes} -eq 1 ]]; then
    	echo "${geneSymbol};true" >> /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_38_89_versus_CKB.csv
    else
	    echo "${geneSymbol};false" >> /data/experiments/check_ensembl_versus_CKB_genes/output/genes_map_38_89_versus_CKB.csv
    fi

done < ${genes_map_37_89}