#!/usr/bin/env bash

msg() {
    local msg_type=$1 && shift
    local msg_content=$* && shift
    echo "[${msg_type}] $(date +'%y%m%d %T') - ${msg_content}"
}

msg_with_caller() {
    local msg_type=$1 && shift
    local msg_content=$* && shift
    # bash caller builtin returns '$line $filename'
    caller=$(basename "$(caller | cut -d" " -f2)")
    echo "[${msg_type}] $(date +'%y%m%d %T') (${caller}) - ${msg_content}"
}

error() {
    msg "ERROR" "$@" >&2
    exit 1
}

die() {
    msg "ERROR" "$@" >&2
    exit 1
}

warn() { 
    msg "WARN" "$@" >&2
}

info() {
    msg "INFO" "$@"
}

