#!/bin/bash
source locate_files
source load_metadata

prefix=`dirname $(readlink $0 || echo $0)`
run_dir=$1 && shift

credentials=/data/common/dbs/mysql_credentials/gridss_test
sv_jar=/data/common/tools/variantannotator_pilot/variant-annotator.jar
gridss_jar=/data/common/tools/gridss_v2.0.1/gridss.jar
sample=$(load_tumor_sample_from_metadata ${run_dir})
structural_vcf=$(locate_purple_structural_variants ${run_dir})

annotated_structural_vcf=${structural_vcf/.sv.vcf.gz/.sv.ann.vcf.gz}

do_run_gridss_viral_annotate ${run_dir} ${gridss_jar}

${prefix}/do_run_sv_loader ${sample} ${annotated_structural_vcf} ${credentials} ${sv_jar} $@
