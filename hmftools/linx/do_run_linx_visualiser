#!/bin/bash
source load_metadata

run_dir=$1 && shift
input_dir=${run_dir}/sv

# Load metadata
tumor_sample=$(load_tumor_sample_from_metadata ${run_dir})

links=${input_dir}/${tumor_sample}.linx.vis_sv_data.csv
exons=${input_dir}/${tumor_sample}.linx.vis_gene_exon.csv
segments=${input_dir}/${tumor_sample}.linx.vis_segments.csv
cna=${input_dir}/${tumor_sample}.linx.vis_copy_number.csv

sv_jar=/data/common/tools/linx_pilot/sv-analyser.jar
circos=/data/common/tools/circos_v0.69.6/bin/circos

java -cp ${sv_jar} com.hartwig.hmftools.svanalysis.SvVisualiser \
    -sample ${sample} \
    -plot_out ${input_dir}/plot/ \
    -data_out ${input_dir}/data/ \
    -segment ${segments} \
    -link ${links} \
    -exon ${exons} \
    -cna ${cna} \
    -circos ${circos} \
    $@


#Example usage
#   do_run_sv_visualiser CPCT02020258T /data/experiments/sv/SVA_VIS_SEGMENTS.csv /data/experiments/sv/SVA_VIS_SVS.csv /data/experiments/sv/SVA_VIS_GENE_EXONS.csv
#   do_run_sv_visualiser CPCT02020258T /data/experiments/sv/SVA_VIS_SEGMENTS.csv /data/experiments/sv/SVA_VIS_SVS.csv /data/experiments/sv/SVA_VIS_GENE_EXONS.csv -threads 1 -chromosome 15 -debug
#
# Optional arguments
#
# -threads  sets number of threads
# -chromosome   will only produce plot for supplied chromosome
# -clusterId    will only produce plot for supplied clusterId
# -debug    replaces sv positions with sv id

