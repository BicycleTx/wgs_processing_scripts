#!/usr/bin/env bash

source message_functions || exit 1
source locate_gcp_files || exit 1

set -e

registration_jsons_bucket=$(locate_sample_registration_jsons_at_gcp) || die "Could not find registration jsons bucket path"
registration_logs_bucket=$(locate_sample_registration_logs_at_gcp) || die "Could not find registration logs bucket path"

info "Syncing registered JSONs and logs from GCP"
gcloud auth activate-service-account --key-file /data/common/dbs/gcp_credentials/hmf-ops
gsutil -m rsync "${registration_jsons_bucket}" /data/ops/api/prod/jsons/registered/
gsutil -m rsync "${registration_logs_bucket}" /data/ops/api/prod/logs/
info "Registered JSONs and logs synchronised"
