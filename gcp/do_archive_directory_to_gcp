#!/usr/bin/env bash

local_path=$1 && shift
remote_archive_dir=$1 && shift

gcloud auth activate-service-account --key-file=/data/common/dbs/gcp_credentials/hmf-archive

# -d = delete files on GS that no longer exist on datastore
# -e = exclude symlinks to go to GS
# -r = Recursive
# TODO: consider granting hmf-download read-only access?
gsutil -u hmf-database -m rsync -d -r -e ${local_path} s3://hmf-archive/${remote_archive_dir}