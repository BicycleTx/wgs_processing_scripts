#!/bin/bash

OUTDIR=~/hmf/out
BACKUPDIR=~/hmf/oldout

#Binary Diff - ignore index files, zip files and pdf
diff ${OUTDIR}/ ${BACKUPDIR}/ | egrep "Binary" | egrep -v ".idx|.zip|.pdf" > diff.txt

#Text Diff - ignore lines that contain timestamps
diff ${OUTDIR}/ ${BACKUPDIR}/ | egrep -v "##GATK|##startTime|</td>" | egrep -B 2 "<|>" >> diff.txt

if [[ -s myDiff.txt ]] ; then
    echo -e '\n----Regression Test Failed----\n\nFiles with Differences: (for more details see also diff.txt)\n'
    grep diff diff.txt
    echo -e '\n'
else
    echo -e '\n----Regression Test Passed----\n'	
fi
