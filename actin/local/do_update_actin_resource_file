#!/usr/bin/env bash

source message_functions || exit 1

source_file=$1 && shift
target_file=$1 && shift
target_dir=$1 && shift

if [[ -z "${source_file}" || -z "${target_file}" || -z "${target_dir}" ]]; then
    error "Missing parameters. Exiting."
fi

if [[ -f "${source_file}" ]]; then
    info "Renaming ${source_file} to ${target_file}"
    mv "${source_file}" "${target_file}"
fi

if [[ -f "${target_file}" ]]; then
    info "Uploading ${target_file} to ${target_dir}/"
    gcloud compute scp ${target_file} data-vm-prod-1:${target_dir}/
fi