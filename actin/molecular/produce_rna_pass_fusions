#!/usr/bin/env bash

source locate_files || exit 1
source message_functions || exit 1

base_dir="/data/experiments/rna"

# NOTES:
#  Latest ISOFOX in batch-jobs produces PASS fusions, so this script should not be needed anymore for new samples. For older samples:
#  - The ACTN isofox data (${run_dir}/isofox/*) has to be copied into the experiment ACTN folder
#  - The ACTN sample along with cancer type has to be added to actn_sample_ids.csv
#  - This script produces pass_fusions in the output dir which need to be copied back to run_dir isofox dir.

isofox_jar="$(locate_pilot_isofox)"

info "Running isofox FUSION cohort analyser for ACTIN"

java -cp ${isofox_jar} com.hartwig.hmftools.isofox.cohort.CohortAnalyser \
    -root_data_dir "${base_dir}/samples/ACTN" \
    -output_dir "${base_dir}/samples/ACTN" \
    -sample_data_file $(locate_actin_rna_sample_metadata_file) \
    -analyses FUSION \
    -fusion_write_filtered \
    -fusion_cohort_file "${base_dir}/cohort/hmf_isofox_fusion_cohort.csv" \
    -known_fusion_file "$(locate_known_fusion_data_37_csv)"
